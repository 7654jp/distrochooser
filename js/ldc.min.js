function LDC(a,b){this.systemVars=a;this.distributions=[];this.distributionsAfterAnswer=[];this.questions=[];this.answers=[];this.language=b;this.ApplyTitle=ApplyTitle;this.GetSystemValue=GetSystemValue;this.Init=Init;this.GetDistros=GetDistros;this.GetQuestions=GetQuestions;this.SwitchLanguage=SwitchLanguage;this.SetUpUI=SetUpUI;this.InsertQuestions=InsertQuestions;this.FilterByAnswer=FilterByAnswer;this.ApplySearch=ApplySearch;this.PostAnswerClick=PostAnswerClick;this.GetResult=GetResult;this.ApplyFilterResults=ApplyFilterResults;this.CreateResultMatrix=CreateResultMatrix;this.SerializeResult=SerializeResult;this.UnserializeResult=UnserializeResult;this.NotAnEasterEgg=NotAnEasterEgg;this.ApplyRelativeResults=ApplyRelativeResults;this.Init()}function GetSystemValue(b){for(var a=0;a<this.systemVars.length;a++){if(this.systemVars[a].Val==b){return this.systemVars[a].Text}}return""}function SetUpUI(){ldc.ApplyTitle();$(".ldcui").each(function(a,c){var d=$(this).attr("id");var c=ldc.GetSystemValue(d);if(d==undefined||c==""){var b=$(this).attr("class").split(" ");d=b[b.length-1];c=ldc.GetSystemValue(d)}if(c!=""){$(this).html(c)}});$("#answeredCount").text("0");$("#welcomeTextHeader").trigger("click");$("#twitterlink").attr("href","https://twitter.com/share?text="+ldc.GetSystemValue("FindTheRightLinux")+"&url=http://distrochooser.0fury.de/?r=tw&hashtags=distrochooser,linux");$("#getresult").click(function(){$.post("./rest.php",{method:"AddResult",args:JSON.stringify(ldc.distributionsAfterAnswer),lang:ldc.language}).done(function(a){GetResult()})});$("#startTest").click(function(){$("#Heading1").trigger("click")})}function ApplyTitle(){document.title=this.GetSystemValue("Title")}function SwitchLanguage(a){ldc.language=a;ldc.Init()}function GetResult(){$("#ResultContent").empty();if(ldc.distributionsAfterAnswer[0].percentage){$("#ResultContent").html("<div class='alert alert-info'>"+ldc.GetSystemValue("RelativeResults")+"</div>")}for(var b=0;b<ldc.distributionsAfterAnswer.length;b++){var h="";h="<div class='panel panel-default'>";h=h+"<div class='panel-heading'>"+ldc.distributionsAfterAnswer[b].Name;if(ldc.distributionsAfterAnswer[b].percentage){h=h+": "+ldc.distributionsAfterAnswer[b].percentage+"%"}h=h+"</div>";h=h+"<div class='panel-body'>";h=h+"<img class='linuxlogo' src='"+ldc.distributionsAfterAnswer[b].Image+"'></img>"+ldc.distributionsAfterAnswer[b].Description+"</div>";h=h+"<div class='panel-footer properties hidden-xs'><a class='detail' target='_blank' href='"+ldc.distributionsAfterAnswer[b].Homepage+"'>Website</a><a target='_blank' class='detail'  href='./detail.php?id="+ldc.distributionsAfterAnswer[b].Id+"&l="+ldc.language+"'>Details</a></div>";h=h+"</div>";$("#ResultContent").append(h)}if(ldc.distributionsAfterAnswer.length==0){$("#ResultContent").html("<div class='alert alert-info'>"+ldc.GetSystemValue("NoResults")+"</div>")}var f=ldc.CreateResultMatrix();$("#matrix").empty();var d="<tr><th></th>";for(var b=ldc.distributions.length-1;b>=0;b--){d+="<th><div class='verticalText'><a href='./detail.php?id="+ldc.distributions[b].Id+"'>"+ldc.distributions[b].Name+"</a></div></th>"}d+="</th>";$("#matrix").append(d);for(var g in f){var j="<tr>";var k='<a href="#" type="button" class="questionbtn" data-toggle="popover" title="" data-content=\''+g+'\' data-trigger="focus" tabindex="0"><i class="glyphicon glyphicon-question-sign"></i></a>';j+="<td>"+k+"</td>";var e=2;for(var b=ldc.distributions.length-1;b>=0;b--){var a=$("#matrix th:nth-child("+e+") div").first().text();if(f[g][b]==a){j+='<td><i class="ok glyphicon glyphicon-ok"></td>'}else{j+='<td><i class="no glyphicon glyphicon-remove"></i></td>'}e++}j+="</tr>";$("#matrix").append(j)}var c=$("#matrix").html();$(".questionbtn").popover();$("#modal").modal()}function PostAnswerClick(){$("#answeredCount").text(ldc.answers.length);ldc.ApplyFilterResults();if(ldc.answers.length==ldc.questions.length){if(ldc.distributionsAfterAnswer.length==0){$("#getresult").removeClass("btn-success");$("#getresult").addClass("btn-danger");if($("#zerodistros").length==0){var a=this.GetSystemValue("zerodistros");$("#rightBar").append("<li id='zerodistros' class='list-group-item'><div iclass='alert alert-danger'>"+a+"</div></li>")}}else{$("#zerodistros").remove();$("#getresult").removeClass("btn-danger");$("#getresult").removeClass("btn-primary");$("#getresult").addClass("btn-success")}}else{$("#getresult").removeClass("btn-danger");$("#zerodistros").remove();$("#getresult").removeClass("btn-success");$("#getresult").addClass("btn-primary")}}function FilterByAnswer(b){var d=/\d+/.exec(b)[0];var a=/\d+/.exec($("#"+b).parent().parent().parent().attr("id"))[0];if(ldc.answers.indexOf(d)==-1){if($("#Question_"+a+" ul li a[ldc_selected]").length==0){ldc.answers.push(d);var c=$("#Question_"+a).parent().parent()[0].children[0].id;$("#"+c).append("<h4 class='answered'>"+ldc.GetSystemValue("questionanswered").toUpperCase()+"</h4>");$("#"+b+"").append(" <span id='"+b+"_Selection' class='glyphicon glyphicon-ok'></span>");$("#"+b).attr("ldc_selected","true");$("#"+b+"_Selection").hover(function(){$(this).css("color","darkred");$(this).removeClass("glyphicon-ok");$(this).addClass("glyphicon-remove")});$("#"+b+"_Selection").mouseout(function(){$(this).removeClass("glyphicon-remove");$(this).addClass("glyphicon-ok");$(this).css("color","")})}else{$("#Question_"+a+" ul li a[ldc_selected] span").remove();$("#Question_"+a+" ul li a[ldc_selected]").removeAttr("ldc_selected");ldc.answers.splice(ldc.answers.indexOf(d),1);ldc.answers.push(d);var c=$("#Question_"+a).parent().parent()[0].children[0].id;$("#"+c).append("<h4 class='answered'>"+ldc.GetSystemValue("questionanswered").toUpperCase()+"</h4>");$("#"+b+"").append(" <span id='"+b+"_Selection' class='glyphicon glyphicon-ok'></span>");$("#"+b).attr("ldc_selected","true")}}else{var c=$("#Question_"+a).parent().parent()[0].children[0].id;$("#"+c+" h4").last().remove();$("#"+b+" span").remove();$("#"+b).removeAttr("ldc_selected");ldc.answers.splice(ldc.answers.indexOf(d),1)}console.log("id: "+d);ldc.ApplySearch(d)}function ApplySearch(g){var b=[];for(var e=0;e<ldc.distributions.length;e++){var c=false;var d=ldc.distributions[e];var f=0;for(var a=0;a<d.Answers.length;a++){if(ldc.answers.indexOf(d.Answers[a])!=-1){f++}}c=(f==ldc.answers.length);if(c){b.push(d)}}ldc.distributionsAfterAnswer=b.slice();if(ldc.distributionsAfterAnswer.length==0){console.log("Entering relative mode");ldc.distributionsAfterAnswer=[];ldc.distributionsAfterAnswer=ldc.ApplyRelativeResults()}else{console.log("Entering absolute mode")}}function ApplyRelativeResults(){var f=[];var g=ldc.answers.length;for(var e=ldc.distributions.length-1;e>=0;e--){var b=0;var d=ldc.distributions[e];for(var a=0;a<d.Answers.length;a++){if(ldc.answers.indexOf(d.Answers[a])!=-1){b++}}if(b!=0){var c=Math.round(100/(g/b),2);var h=jQuery.extend({},d);h.percentage=c;f.push(h)}}f.sort(compare);return f}function compare(d,c){if(d.percentage<c.percentage){return 1}if(d.percentage>c.percentage){return -1}return 0}function ApplyFilterResults(){$("#hitCount").html(ldc.distributionsAfterAnswer.length);$("#allCount").html(ldc.distributions.length)}function InsertQuestions(){for(var f=0;f<ldc.questions.length;f++){var e=ldc.questions[f];var d=htmlInject.replace(new RegExp("{{ID}}","g"),e.Id);d=d.replace(new RegExp("{{TITLE}}","g"),(f+1)+". "+e.Text);d=d.replace(new RegExp("{{QUESTION}}","g"),e.Help);var g="<ul >";for(var a=0;a<e.Answers.length;a++){g=g+"<li><a id='Answer_"+e.Answers[a].Id+"'>"+e.Answers[a].Text+"</a></li>"}var c=(f<ldc.questions.length-1)?false:true;g=g+"</ul>";if(!c){var b="#";g+="<a href='#collapse"+f+"' class='btn btn-primary next ldcui' id='nextQuestion'>"+ldc.GetSystemValue("nextQuestion")+"</a>"}d=d.replace(new RegExp("{{CONTENT}}","g"),g);$("#accordion").append(d);if(!c){$(".next").click(function(){$(this).parent().parent().parent().next().children().first().trigger("click")})}for(var a=0;a<e.Answers.length;a++){$("#Answer_"+e.Answers[a].Id).click(function(){ldc.FilterByAnswer($(this).attr("id"));ldc.PostAnswerClick()})}}$("[data-parent='#accordion']").click(function(){if($(this).attr("href")=="#collapseOne"){$("#homelink").fadeOut();$("#rightBar").fadeOut()}else{$("#homelink").fadeIn();$("#rightBar").fadeIn()}})}function Init(){var a="There are no easter eggs..or maybe..it's classified";$.post("./rest.php",{method:"GetSystemVars",args:"[]",lang:this.language}).done(function(b){ldc.systemVars=$.parseJSON(b);ldc.GetDistros();ldc.GetQuestions();ldc.SetUpUI()})}function NotAnEasterEgg(){$("#homelink").children().first().attr("src","./assets/0002.gif");$(".largelogo").attr("src","./assets/0002.gif")}function GetDistros(){$.post("./rest.php",{method:"GetDistributions",args:"[]",lang:this.language}).done(function(c){var a=$.parseJSON(c);var d=[];for(var b=0;b<a.length;b++){d.push(a[b])}ldc.distributions=d;ldc.distributionsAfterAnswer=ldc.distributions.slice();ldc.ApplyFilterResults();ldc.UnserializeResult()})}function GetQuestions(){$.post("./rest.php",{method:"GetQuestions",args:"[]",lang:this.language}).done(function(d){var a=$.parseJSON(d);var c=[];for(var b=0;b<a.length;b++){c.push(a[b])}ldc.questions=c;$("#answerCount").text(ldc.questions.length);ldc.InsertQuestions()})}function CreateResultMatrix(){var c={};for(var d=ldc.questions.length-1;d>=0;d--){var g=ldc.questions[d];for(var h=g.Answers.length-1;h>=0;h--){var b=[];var e=g.Answers[h].Id;if(ldc.answers.indexOf(e)!=-1||ldc.answers.length==0){for(var a=ldc.distributions.length-1;a>=0;a--){var f=ldc.distributions[a].Answers;if(f.indexOf(e)!=-1){if(b.indexOf(ldc.distributions[a].Name)==-1){b[ldc.distributions.indexOf(ldc.distributions[a])]=(ldc.distributions[a].Name)}}c[g.Text+": "+g.Answers[h].Text]=b}}}}return c}function SerializeResult(){var a="";for(var b=0;b<ldc.answers.length;b++){a+=ldc.answers[b];if(b!=ldc.answers.length-1){a+=","}}return a}function UnserializeResult(){var d=getUrlVars("answers");if(d.answers===undefined){ldc.answers=[]}else{ldc.answers=d.answers.split(",")}for(var b=0;b<ldc.answers.length;b++){var f=/\d+/.exec(ldc.answers[b])[0];var c="Answer_"+f;var a=/\d+/.exec($("#"+c).parent().parent().parent().attr("id"))[0];var e=$("#Question_"+a).parent().parent()[0].children[0].id;$("#"+e).append("<h4 class='answered'>"+ldc.GetSystemValue("questionanswered").toUpperCase()+"</h4>");$("#"+c+"").append(" <span id='"+c+"_Selection' class='glyphicon glyphicon-ok'></span>");$("#"+c).attr("ldc_selected","true");$("#"+c+"_Selection").hover(function(){$(this).css("color","darkred");$(this).removeClass("glyphicon-ok");$(this).addClass("glyphicon-remove")});$("#"+c+"_Selection").mouseout(function(){$(this).removeClass("glyphicon-remove");$(this).addClass("glyphicon-ok");$(this).css("color","")});ldc.ApplySearch(f)}ldc.PostAnswerClick();ldc.ApplyFilterResults()};